function translateValidationMessage(a){var e=CURRENCY||"BRL";return{BRL:messagesValidPtBr,USD:messagesValidEn,MXN:messagesValidEs,COP:messagesValidEs,EUR:messagesValidEn}[e][a]}function translatePurchaseFlowMessage(a){var e=CURRENCY||"BRL";return{BRL:messagesSwalPurchaseFlowPtBr,USD:messagesSwalPurchaseFlowEn,MXN:messagesSwalPurchaseFlowEs,COP:messagesSwalPurchaseFlowEs,EUR:messagesSwalPurchaseFlowEn}[e][a]}function iniciaCardValidator(a){if(document.getElementById("pagamento-cartao")){var e=function(){var a=$('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val(),e="";Payment&&(e=Payment.fns.cardType(a));var t="amex"===e?4:3,o={luhn:cardValidator.number($('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val()).isValid,cvc:cardValidator.cvv($('[data-name="codigo_seguranca"][data-cartao="'+tipoDataCartao+'"]').val(),t).isValid,holderName:!0,expirationDate:cardValidator.expirationDate({month:$('[data-name="mes"][data-cartao="'+tipoDataCartao+'"]').val(),year:$('[data-name="ano_exibido"][data-cartao="'+tipoDataCartao+'"]').val()}).isValid};return o.valid=o.luhn&&o.cvc&&o.expirationDate,cardIsValid=o.valid,o};$(a).on("submit",function(a){if(a.preventDefault(),compraComDoisCartoes){if(tipoDataCartao="credito_1",getCardValidation(e()),!cardIsValid)return;return tipoDataCartao="credito_2",void getCardValidation(e())}getCardValidation(e())}),$(a).on("keyup","[id^=pagamento-cartao] input",function(a){var t=e();getCardValidation(t),tipoDataCartao=a.currentTarget.dataset.cartao,t.valid&&cardSerialize!=$("#pagamento-cartao[data-cartao='"+tipoDataCartao+"'] input").serialize()&&(cardSerialize=$("#pagamento-cartao[data-cartao='"+tipoDataCartao+"']input").serialize())})}}function resetTokenFields(){tokenDefer=jQuery.Deferred().reject(),$('input[name="mp_token"]').val(""),$('input[name="pagarme_token"]').val(""),$('input[name="pagarme_retentativa_token"]').val(""),$('input[name="pagarme_retentativa_token_2"]').val(""),$('input[name="token_cartao"]').val(""),$('input[name="token_cartao2"]').val(""),$("input[name=paymentMethodId]").val(""),$("input[name=payment_type]").val("")}function defineDelay(a,e){return setTimeout(function(){tokenDefer.resolve(e)},a)}function generateTokens(a){var e,t=[];switch(!0===a&&resetTokenFields(),tokenDefer.state()){case"rejected":tokenDefer=jQuery.Deferred();break;case"pending":case"resolved":return tokenDefer}return $('[name="tipo_pagamento"]').val()==TIPO_PAGAMENTO.CARTAO||$('[name="tipo_pagamento"]').val()==TIPO_PAGAMENTO.FRACIONADO&&$("#primeira_cobranca_cartao").prop("checked")?compraComDoisCartoes&&$('[name="tipo_pagamento"]').val()==cartao?(tokenDefer.resolve(),tokenDefer):(tokenDefer.progress(function(a){compraComDoisCartoes||(e||(e=defineDelay(5e3,t)),t.push(a),mustVerifyZeroAuth()&&("iugu"==a&&(clearTimeout(e),e=defineDelay(1e4,t),zeroAuth()),-1==t.indexOf("zeroAuth"))||-1!=t.indexOf("PagSeguro")&&-1!=t.indexOf("iugu")&&-1!=t.indexOf("wallet")&&tokenDefer.resolve(t))}),tokenDefer.then(function(){clearTimeout(e)}),getIuguToken(null,iuguResponseHandler),generateTokenWallet(),generateTokenPagSeguro(),tokenDefer):(tokenDefer.resolve(),tokenDefer)}function mustVerifyZeroAuth(){if("BRL"!=CURRENCY)return!1;var a=$('[data-name="numero_cartao"]').val().replace(/[^0-9]/g,"");switch(window.Iugu.utils.getBrandByCreditCardNumber(a)){case"visa":case"mastercard":case"elo":return!0;default:return!1}}function zeroAuth(){var a=$("input[name=iugu_token]").val();$.ajax({url:zeroAuthUrl+a,data:{name:$('input[name="nome"]').val(),document:$('input[name="documento"]').val().replace(/\D/g,""),email:$("#email").val()},type:"GET",success:function(a){if("pending"==tokenDefer.state()){if(a.zero_auth.valid)return void tokenDefer.notify("zeroAuth");swal({title:"Cartão inválido!",html:"Verifique se os dados do seu cartão estão corretos e tente novamente.",type:"warning",showCancelButton:!1,allowOutsideClick:!1}),tokenDefer.reject()}},error:function(a){tokenDefer.notify("zeroAuth")}})}function mpResponseHandler(a,e){200!=a&&201!=a||$('input[name="mp_token"]').val(e.id),tokenDefer.notify("MercadoPago")}function iuguResponseHandler(){tokenDefer.notify("iugu")}function generateTokenMercadoPago(){var a=document.head.querySelector('meta[name="mp-public-token"]');if(a){var e="https://api.mercadopago.com/v1/card_tokens?public_key="+a.content,t={site_id:"MLB",card_number:$('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val().replace(/[^0-9]/g,""),security_code:$('[data-name="codigo_seguranca"][data-cartao="'+tipoDataCartao+'"]').val(),expiration_month:$('[data-name="mes"][data-cartao="'+tipoDataCartao+'"]').val(),expiration_year:"20"+$('[data-name="ano_exibido"][data-cartao="'+tipoDataCartao+'"]').val(),cardholder:{name:$('[data-name="full_name"][data-cartao="'+tipoDataCartao+'"]').val(),identification:{number:$("#documento").val().replace(/\D/g,""),type:$("#documento").val().replace(/\D/g,"").length>11?"CNPJ":"CPF"}}};"BR"!=$("#pais").val()&&delete t.cardholder.identification,$.ajax({async:!0,crossDomain:!0,url:e,method:"POST",headers:{Accept:"application/json","Content-Type":"application/json"},data:JSON.stringify(t),dataType:"json"}).success(function(a){"active"==a.status&&($('input[name="mp_token"]').val(a.id),tokenDefer.notify("MercadoPago"))})}}function generateTokenPagSeguro(){if("undefined"==typeof PagSeguro)return void tokenDefer.notify("PagSeguro");$("input[name=pag_seguro_token]").remove();var a=PagSeguro.encryptCard({publicKey:PAG_SEGURO_PUBLIC_KEY,holder:$('[data-name="full_name"][data-cartao="'+tipoDataCartao+'"]').val(),number:$('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val().replace(/[^0-9]/g,""),expMonth:$('[data-name="mes"][data-cartao="'+tipoDataCartao+'"]').val(),expYear:"20"+$('[data-name="ano_exibido"][data-cartao="'+tipoDataCartao+'"]').val(),securityCode:$('[data-name="codigo_seguranca"][data-cartao="'+tipoDataCartao+'"]').val()});if(a.hasErrors)return void tokenDefer.notify("PagSeguro");$(formulario).append('<input type="hidden" name="pag_seguro_token" value="'+a.encryptedCard+'">'),tokenDefer.notify("PagSeguro")}function generateTokenPagarMe(){var a={};a.card_holder_name=$('[data-name="full_name"][data-cartao="'+tipoDataCartao+'"]').val(),a.card_expiration_date=$('[data-name="mes"][data-cartao="'+tipoDataCartao+'"]').val()+"/"+$('[data-name="ano_exibido"][data-cartao="'+tipoDataCartao+'"]').val(),a.card_number=$('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val(),a.card_cvv=$('[data-name="codigo_seguranca"][data-cartao="'+tipoDataCartao+'"]').val(),pagarme.client.connect({encryption_key:KEY_PAGAR_ME}).then(function(e){return e.security.encrypt(a)}).then(function(a){$('input[name="pagarme_token"]').val(a)}).finally(function(){tokenDefer.notify("PagarMe")})}function generateTokenWallet(){if("undefined"==typeof Wallet)return void tokenDefer.notify("wallet");var a={};a.number=$('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val(),a.name=$('[data-name="full_name"][data-cartao="'+tipoDataCartao+'"]').val(),a.month=$('[data-name="mes"][data-cartao="'+tipoDataCartao+'"]').val(),a.year=(new Date).getFullYear().toString().substr(0,2)+$('[data-name="ano_exibido"][data-cartao="'+tipoDataCartao+'"]').val(),a.cvv=$('[data-name="codigo_seguranca"][data-cartao="'+tipoDataCartao+'"]').val(),$("input[name=wallet_token]").remove(),Wallet(walletKey).generateToken(a).then(function(a){$(formulario).append('<input type="hidden" name="wallet_token" value="'+a+'">'),tokenDefer.notify("wallet")}).catch(function(){tokenDefer.notify("wallet")})}function generateTokenPagarMeRetentativaDoisCartoes(){if(compraComDoisCartoes||$('[name="tipo_pagamento"]').val()!=cartao){var a={};a.card_holder_name=$('[data-name="full_name"][data-cartao="credito_1"]').val(),a.card_expiration_date=$('[data-name="mes"][data-cartao="credito_1"]').val()+"/"+$('[data-name="ano_exibido"][data-cartao="credito_1"]').val(),a.card_number=$('[data-name="numero_cartao"][data-cartao="credito_1"]').val(),a.card_cvv=$('[data-name="codigo_seguranca"][data-cartao="credito_1"]').val();var e={};if(e.card_holder_name=$('[data-name="full_name"][data-cartao="credito_2"]').val(),e.card_expiration_date=$('[data-name="mes"][data-cartao="credito_2"]').val()+"/"+$('[data-name="ano_exibido"][data-cartao="credito_2"]').val(),e.card_number=$('[data-name="numero_cartao"][data-cartao="credito_2"]').val(),e.card_cvv=$('[data-name="codigo_seguranca"][data-cartao="credito_2"]').val(),"undefined"==typeof pagarme)return tokenDefer.notify("PagarMe Retentativa"),void tokenDefer.notify("PagarMe Retentativa");pagarme.client.connect({encryption_key:KEY_PAGAR_ME_RETENTATIVA}).then(function(e){return e.security.encrypt(a)}).then(function(a){$('input[name="pagarme_retentativa_token"]').val(a)}).finally(function(){tokenDefer.notify("PagarMe Retentativa")}),pagarme.client.connect({encryption_key:KEY_PAGAR_ME_RETENTATIVA}).then(function(a){return a.security.encrypt(e)}).then(function(a){$('input[name="pagarme_retentativa_token_2"]').val(a)}).finally(function(){tokenDefer.notify("PagarMe Retentativa 2")})}}function generateTokenPagarMeRetentativa(){var a={};a.card_holder_name=$('[data-name="full_name"][data-cartao="'+tipoDataCartao+'"]').val(),a.card_expiration_date=$('[data-name="mes"][data-cartao="'+tipoDataCartao+'"]').val()+"/"+$('[data-name="ano_exibido"][data-cartao="'+tipoDataCartao+'"]').val(),a.card_number=$('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val(),a.card_cvv=$('[data-name="codigo_seguranca"][data-cartao="'+tipoDataCartao+'"]').val(),pagarme.client.connect({encryption_key:KEY_PAGAR_ME_RETENTATIVA}).then(function(e){return e.security.encrypt(a)}).then(function(a){$('input[name="pagarme_retentativa_token"]').val(a)}).finally(function(){tokenDefer.notify("PagarMe Retentativa")})}function getBin(){return $('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val().replace(/[^0-9]/g,"").substring(0,6)}function setPaymentMethodInfo(a,e){200==a?($("input[name=paymentMethodId]").val(e[0].id),$("input[name=payment_type]").val(e[0].payment_type_id)):console.log("payment method info error: "+e)}function setCurrencyUriBrowser(a){a=a.toUpperCase();var e=new URLSearchParams(window.location.search);e.set("currency",a);var t=window.location.origin+window.location.pathname+"?"+e.toString();window.history.pushState({path:t},"",t)}function resetRecaptcha(){"undefined"!=typeof grecaptcha&&grecaptcha.reset()}function showRecaptcha(){2==qtdadeTentativas&&$("#recaptcha").show()}function validaDadosComprador(){var a=!0;return formatoProdutoId==PRODUTO_FISICO&&($("#frete-error").addClass("esconder"),$('input[name="servico"]:checked').val()||($('input[name="servico"]').focus(),$("#frete-error").removeClass("esconder"),a=!1,"1"!=solicitarEndereco&&(a=!0)),!planoGratis&&calculoFrete||(a=!0)),$('input[name="nome"]').val()||(a=!1),$("#sem_email").is(":checked")||$("#email").val()||(a=!1),$('input[name="documento"]').val()||"BRL"!=CURRENCY||(a=!1),$("#form-checkout-venda").validate(),a}function alteraNacionalidade(){var a=$("#pais option:selected").val();"BR"!=a?($('input[name="nacionalidade"]').val(estrangeiro),$("#aviso_endereco_brasil").removeClass("esconder"),$("#pagarcom-boleto,#pagarcom-fracionado").addClass("hidden"),$("#pagarcom-cartao").click(),$("#pagarcom-pix").hide()):($('input[name="nacionalidade"]').val(brasileiro),$("#aviso_endereco_brasil").addClass("esconder"),$("#pagarcom-boleto,#pagarcom-fracionado").removeClass("hidden"),$("#pagarcom-pix").show()),$("#celular").val()||iti.setCountry(a)}function verificaCampoEmail(){$("#sem_email").is(":checked")?($("#email").attr("disabled",!0),$("#confirmacao_email").attr("disabled",!0),$("#telefone_obrigatorio").show()):($("#email").removeAttr("disabled"),$("#confirmacao_email").removeAttr("disabled"),$("#telefone_obrigatorio").hide())}function maskTel(a){if(a)return void $("#celular").mask(a);if("br"==iti.selectedCountryData.iso2){if($("#celular").val().length<12)return void $("#celular").mask("00 0000-0000");$("#celular").mask("00 00000-0000")}}function holdFingerprint(){$('[name="tipo_pagamento"]').val()==TIPO_PAGAMENTO.CARTAO&&(aguardaCarregarFingerprint=!0),setTimeout(function(){aguardaCarregarFingerprint=!1},5e3)}function removeCaracteresEspeciais(a){var e=a.target.value.replace(/(?:[\0-\x1F!-&\(-\/:-@\[-\^\{-\xBF\xC4-\xC6\xCB\xCF-\xD1\xD6-\xD8\xDC-\xDF\xE4-\xE6\xEB\xEF-\xF1\xF6-\xF8\xFC-\u02C5\u02C7-\u02DB\u02DD-\uD7FF\uE000-\uFFFF]|[\uD800-\uDBFF][\uDC00-\uDFFF]|[\uD800-\uDBFF](?![\uDC00-\uDFFF])|(?:[^\uD800-\uDBFF]|^)[\uDC00-\uDFFF])+/g,"");a.target.value=e}if(void 0===compraComDoisCartoes)var compraComDoisCartoes=!1;if(void 0===calculoFrete)var calculoFrete=!0;if(void 0===termos)var termos=!1;var maskTelPlaceHolder=$("#celular").attr("placeholder");Iugu.setAccountID(iuguID),Iugu.setTestMode(testMode),window.lazyLoadOptions={elements_selector:".lazy"};var visitorData=sessionStorage.getItem("fingerprint_braip")?JSON.parse(atob(sessionStorage.getItem("fingerprint_braip"))):{},cardIsValid=!1,valorCupom=0,timeStart=new Date,userBuy=!1,tokenDefer=jQuery.Deferred().reject(),fingerPrintProDeferred=jQuery.Deferred(),cardSerialize,aguardaCarregarFingerprint=!1,formulario=document.getElementById("form-checkout-venda"),emailValido=function(a){return/^[a-z0-9._-]+@[a-z0-9]+\.[a-z]+(\.[a-z]+)?$/i.test(a)};jQuery.validator.addMethod("validate_email",emailValido,translateValidationMessage("validate_email"));var validaTel=function(){var a=$("#celular").prop("maxlength")-1;return!($("#celular").val().length<a)};jQuery.validator.addMethod("validate_tel",validaTel,translateValidationMessage("validate_tel"));var EmailDomainSuggester={domains:["gmail.com","hotmail.com","outlook.com","live.com","uol.com.br","bol.com.br","icloud.com","terra.com.br","ig.com.br","yahoo.com","ymail.com"],bindTo:$("#email"),time:0,init:function(){this.addElements(),this.bindEvents(),this.focusOfEvents()},addElements:function(){this.datalist=$("<datalist />",{id:"email-options"}).insertAfter(this.bindTo),this.bindTo.attr("list","email-options")},bindEvents:function(){this.bindTo.on("keyup",this.testValue)},select_content_equals:function(a){var e;return EmailDomainSuggester.domains.forEach(function(t){if(-1!=t.indexOf(a))return void(e=t)}),e},focusOfEvents:function(){this.bindTo.on("focusout",this.selectFirstValue)},selectFirstValue:function(){var a=$(this),e=a.val();if(-1!=e.indexOf("@")){e=e.split("@");var t=EmailDomainSuggester.select_content_equals(e[1]);void 0!=t&&$("#email").val(e[0]+"@"+t)}},testValue:function(a){var e=$(this),t=e.val();-1!=t.indexOf("@")?(t=t.split("@"),void 0!=t[1]&&t[1].length>=2&&EmailDomainSuggester.addDatalist(t[0])):EmailDomainSuggester.datalist.empty()},addDatalist:function(a){var e,t="";for(e=0;e<this.domains.length;e++)$("#email").val()!=a+"@"+this.domains[e]&&(t+="<option value='"+a+"@"+this.domains[e]+"'>");this.datalist.html(t)}};EmailDomainSuggester.init(),iniciaCardValidator(formulario),$(function(){function a(){if(!(e()<30||userBuy)){var a=$("#hash").val(),t=$(formulario).serializeArray();t.push({name:"codigo_pais",value:iti.getSelectedCountryData().dialCode}),$.ajax({headers:{"X-CSRF-TOKEN":$("meta[name='csrf-token']").attr("content")},type:"POST",url:routeAbandono+"/"+a,async:!0,data:t,success:function(a){void 0!=a.abandono&&$("#hash").val(a.abandono)}})}}function e(){var a=new Date;return Math.round((a-timeStart)/1e3)}function t(a){return"Sem token válido."==a||"Esse token já foi usado."==a||null===a?"Não foi possível realizar a cobranca. Por favor, verifique os dados e tente novamente.":a}function o(e){a(),userBuy||(e.preventDefault(),e.returnValue="")}function n(){"vibrate"in window.navigator&&window.navigator.vibrate(100)}if($("#pais").change(function(){alteraNacionalidade()}),visitorData.countryCode){var r=$("select#pais");r.find("option[value='"+visitorData.countryCode+"']").prop("selected",!0),r.trigger("change")}$(".dropdown-btn").click(function(){$(".dropdown-content").toggle()}),$(".dropdown-content .dropdown-item").click(function(a){$(".dropdown-content").hide(),$(this).hasClass("selected")||(window.removeEventListener("beforeunload",o),setCurrencyUriBrowser(this.id),window.location.reload())}),window.addEventListener("beforeunload",o),(/Android|webOS|iPhone|iPad|iPod|BlackBerry|IEMobile|Opera Mini/i.test(navigator.userAgent)||navigator.userAgent.match(/(iPod|iPhone|iPad)/)&&navigator.userAgent.match(/AppleWebKit/))&&(window.addEventListener("blur",function(){a()}),window.addEventListener("pagehide",function(){a()})),$(document).on("change","#celular",function(){var e=$("#celular").val();""!=e&&void 0!=e&&(a(),"function"==typeof sendInitiateCheckoutEvent&&sendInitiateCheckoutEvent({celular:e}))}),$(document).on("change","#email",function(){var e=$("#email").val();""!=e&&void 0!=e&&(a(),"function"==typeof sendInitiateCheckoutEvent&&sendInitiateCheckoutEvent({email:e}))}),$(".valor_pagamento").maskMoney({thousands:".",decimal:","});var i=function(a){return a.replace(/\D/g,"").length>11?($("#docType").val("CNPJ"),"00.000.000/0000-00"):($("#docType").val("CPF"),"000.000.000-009")},l={onKeyPress:function(a,e,t,o){t.mask(i.apply({},arguments),o)}};$(".cpf-cnpj").mask(i,l),$("#confirmacao_email").on("paste",function(a){a.preventDefault()});emailObrigatorio;validator=$("#form-checkout-venda").validate({ignore:":hidden",rules:{nome:{required:!0},sexo:{required:"1"==sexoObrigatorio||"1"==sexoObrigatorio},cep:{required:"1"==enderecoObrigatorio||"1"==solicitarEndereco},endereco:{required:"1"==enderecoObrigatorio||"1"==solicitarEndereco},numero:{required:"1"==enderecoObrigatorio||"1"==solicitarEndereco},bairro:{required:"1"==enderecoObrigatorio||"1"==solicitarEndereco},cidade:{required:"1"==enderecoObrigatorio||"1"==solicitarEndereco},estado:{required:"1"==enderecoObrigatorio||"1"==solicitarEndereco},num_endereco:{required:"1"==enderecoObrigatorio||"1"==solicitarEndereco},servico:{required:!(planoGratis||"1"!=enderecoObrigatorio&&"1"!=solicitarEndereco)},pais:{required:!0},celular:{required:function(){return!0},validate_tel:function(){return!0}},email:{required:function(){return!$("input[name='sem_email']").prop("checked")},validate_email:function(){return!$("input[name='sem_email']").prop("checked")}},documento:{required:"BRL"==CURRENCY,cpf_cnpj:{depends:function(){return"BRL"==CURRENCY}}},confirmacao_email:{required:function(){return!$("input[name='sem_email']").prop("checked")},email:function(){return!$("input[name='sem_email']").prop("checked")},equalTo:function(){return!$("input[name='sem_email']").prop("checked")&&"#email"}}},messages:{nome:{required:translateValidationMessage("required")},sexo:{required:translateValidationMessage("required_select")},email:{required:translateValidationMessage("required"),email:translateValidationMessage("validate_email")},celular:{required:translateValidationMessage("required")},endereco:{required:translateValidationMessage("required")},bairro:{required:translateValidationMessage("required")},cidade:{required:translateValidationMessage("required")},estado:{required:translateValidationMessage("required")},numero:{required:translateValidationMessage("required")},num_endereco:{required:translateValidationMessage("required")},pais:{required:translateValidationMessage("required")},cep:{required:translateValidationMessage("required")},servico:{required:translateValidationMessage("required")},documento:{required:translateValidationMessage("required"),cpf_cnpj:translateValidationMessage("cpf_cnpj")},confirmacao_email:{required:translateValidationMessage("required"),email:translateValidationMessage("validate_email"),equalTo:translateValidationMessage("equal_to")}},errorPlacement:function(a,e){a.insertAfter(e)},onkeyup:function(a){if($('input[name="tipo_pagamento"]').val()==cartao&&cardIsValid&&validator.valid()&&validaDadosComprador())$(formulario.submit).prop("disabled",!1);else if($('input[name="tipo_pagamento"]').val()==boleto&&validator.valid()&&validaDadosComprador())$(formulario.submit).prop("disabled",!1);else if($('input[name="tipo_pagamento"]').val()==fracionado&&validator.valid()&&validaDadosComprador()){var e=$("#primeira_cobranca_cartao").is(":checked");e&&cardIsValid?$(formulario.submit).prop("disabled",!1):e||$(formulario.submit).prop("disabled",!1)}$(a).valid()},onfocusout:function(a){$(a).trigger("keyup")}}),$('[data-popup="desconto"]').on("click",function(){descontoPopupAtivo=!0,cupomAtivo=!1,$('input[name="cupom_ativo"]').val("false"),$('input[name="popup_ativo"]').val("true"),$("#popupDesconto").modal("hide"),swal({title:"Desconto aplicado!",type:"success",timer:"2000",showConfirmButton:!1}),$(document).trigger("braip.pagamento.update")}),$("#buttonTermos").on("click",function(){$("#modalTermosECondicoes").modal()}),$('input[name="termos_e_condicoes"]').change(function(){$(formulario.submit).prop("disabled",!0),this.checked&&($(formulario.submit).prop("disabled",!1),$("#span_termos").hide())}),$("#popupDesconto").on("shown.bs.modal",function(a){$("body").removeClass("modal-open")}),$(formulario).on("submit",function(a){if(a.preventDefault(),aguardaCarregarFingerprint)return!1;if($(formulario.submit).prop("disabled",!0),$('[name="tipo_pagamento"]').val()!=TIPO_PAGAMENTO.FRACIONADO&&(valorValido=!0),qtdadeTentativas>=2&&"undefined"!=typeof grecaptcha&&""==grecaptcha.getResponse())return $(".g-recaptcha div div iframe").css("border","2px solid red"),void $(formulario.submit).prop("disabled",!1);if(termos&&!$('input[name="termos_e_condicoes"]:checked').val())return void $("#span_termos").show();if(!cardIsValid&&($('input[name="tipo_pagamento"]').val()==cartao||$('input[name="tipo_pagamento"]').val()==fracionado&&$("#primeira_cobranca_cartao").is(":checked")))return $('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').focus();if(!valorValido)return $('[data-name="valor_pagamento"][data-cartao="'+tipoDataCartao+'"]').focus();if(recebeContribuicao&&100*$('input[name="valor_total_venda"]').maskMoney("unmasked")[0]<parseFloat(montaValor(valor_plano,$('input[name="tipo_pagamento"]').val(),!0,!0)))return $("#valor_total_venda").focus();if(!validaDadosComprador()||!validator.valid()||!valorValido)return n(),void $(formulario.submit).prop("disabled",!1);if($(formulario.submit).prop("disabled",!1),"undefined"!=typeof isCanSaveLocalStorage&&isCanSaveLocalStorage()&&LocalStorage.salva(),$('[name="tipo_pagamento"]').val()==TIPO_PAGAMENTO.CARTAO||$('[name="tipo_pagamento"]').val()==TIPO_PAGAMENTO.FRACIONADO&&$("#primeira_cobranca_cartao").is(":checked")){var e=translatePurchaseFlowMessage("encrypting_card");swal({title:"<span class='glyphicon glyphicon-shopping-cart'></span> "+e.title,text:e.message,allowOutsideClick:!1,onOpen:function(){swal.showLoading()}})}"undefined"!=typeof grecaptcha&&(qtdadeTentativas++,$("#tentativas").val(qtdadeTentativas)),generateTokens().then(function(){var a=translatePurchaseFlowMessage("processing_purchase");$('[name="tipo_pagamento"]').val()==TIPO_PAGAMENTO.FRACIONADO&&!$("#primeira_cobranca_cartao").is(":checked")||$('[name="tipo_pagamento"]').val()==TIPO_PAGAMENTO.BOLETO||$('[name="tipo_pagamento"]').val()==TIPO_PAGAMENTO.PIX||$('[name="tipo_pagamento"]').val()==TIPO_PAGAMENTO.GRATIS?swal({title:"<span class='glyphicon glyphicon-shopping-cart'></span> "+a.title,text:a.message,allowOutsideClick:!1,onOpen:function(){swal.showLoading()}}):$("#swal2-title").fadeOut(300,function(){$(this).html("<span class='glyphicon glyphicon-shopping-cart'></span> "+a.title).fadeIn(1e3)});var e=$(formulario).serializeArray();if(compraComDoisCartoes){e.push({name:"parcelamento",value:$('[data-name="parcelamento"][data-cartao="'+tipoDataCartao+'"]').val()});for(var o=1;o<=2;o++){tipoDataCartao="credito_"+o;var n=o>1?"_"+o:"";e.push({name:"name"+n,value:$('[data-name="full_name"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"numero_cartao"+n,value:$('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"mes"+n,value:$('[data-name="mes"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"ano"+n,value:$('[data-name="ano_exibido"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"cvc"+n,value:$('[data-name="codigo_seguranca"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"parcelamento_"+o,value:$('[data-name="parcelamento"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"valor_cartao_"+o,value:$('[data-name="valor_pagamento"][data-cartao="'+tipoDataCartao+'"]').val()})}}else e.push({name:"name",value:$('[data-name="full_name"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"numero_cartao",value:$('[data-name="numero_cartao"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"mes",value:$('[data-name="mes"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"ano",value:$('[data-name="ano_exibido"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"cvc",value:$('[data-name="codigo_seguranca"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"parcelamento",value:$('[data-name="parcelamento"][data-cartao="'+tipoDataCartao+'"]').val()}),e.push({name:"valor_pagamento",value:$('[data-name="valor_pagamento"][data-cartao="'+tipoDataCartao+'"]').val()});e.push({name:"codigo_pais",value:iti.getSelectedCountryData().dialCode}),e.push({name:"fingerprint",value:sessionStorage.getItem("visitor_id")}),e.push({name:"fingerprintpro",value:sessionStorage.getItem("fingerprint_braip")}),e=e.map(function(a,e){return"credito_full_name"==a.name||"credito_numero_cartao"==a.name||"credito_mes"==a.name||"credito_ano_exibido"==a.name||"credito_cvc"==a.name||"fracionado_full_name"==a.name||"fracionado_numero_cartao"==a.name||"fracionado_mes"==a.name||"fracionado_ano_exibido"==a.name||"fracionado_cvc"==a.name||"credito_1_full_name"==a.name||"credito_1_numero_cartao"==a.name||"credito_1_mes"==a.name||"credito_1_ano_exibido"==a.name||"credito_1_cvc"==a.name||"credito_2_full_name"==a.name||"credito_2_numero_cartao"==a.name||"credito_2_mes"==a.name||"credito_2_ano_exibido"==a.name||"credito_2_cvc"==a.name?null:a}),$.ajax({headers:{"X-CSRF-TOKEN":$("meta[name='csrf-token']").attr("content")},type:"POST",url:routeSalvaVenda,data:e,success:function(a){if(a.venda&&$("input[name='venda']").val(a.venda),swal.close(),"success"==a.type){var e=translatePurchaseFlowMessage("purchase_success");return userBuy=!0,swal(e.title,e.message,"success"),void(window.location.href=routeObrigado.replace("#",a.venda))}if("invalid_plan"==a.type){var e=translatePurchaseFlowMessage("invalid_plan");swal.close();var o="";o='<div style="text-align: left;padding: 0px 40px;">',o+='<div style="padding-top:7px;">- '+a.messages[0]+"</div>",o+="</div>",swal({title:e.title,html:e.message+": "+o,type:"warning",showCancelButton:!1,confirmButtonClass:"btn-success",confirmButtonText:"Ok!",allowOutsideClick:!1}).then(function(a){window.location.reload()})}else if("invalid_cupom"==a.type){var e=translatePurchaseFlowMessage("invalid_coupon");swal.close(),swal({title:e.title,text:e.message,type:"warning",showCancelButton:!1,confirmButtonClass:"btn-success",confirmButtonText:"Ok!",allowOutsideClick:!1}).then(function(a){$("#cupom-error").html(e.title),$('input[name="cupom_desconto"]').val(""),$('input[name="cupom_desconto"]').prop("disabled",!1),$(".input-group-btn button.btn.btn-default.valid").prop("disabled",!1),$('input[name="cupom_ativo"]').val("false"),$('input[name="cupom_hash"]').val("")}),showRecaptcha(),resetRecaptcha()}else if("invalid_pay_cupom"==a.type){var e=translatePurchaseFlowMessage("invalid_pay_coupon");swal.close(),swal({title:e.title,text:e.message,type:"warning",showCancelButton:!1,confirmButtonClass:"btn-success",confirmButtonText:"Ok!",allowOutsideClick:!1}).then(function(a){$("#cupom-error").html(translatePurchaseFlowMessage("invalid_coupon").title),removeCupom()}),showRecaptcha(),resetRecaptcha()}else if("invalid_buy"==a.type){var e=translatePurchaseFlowMessage("invalid_buy");userBuy=!0;var o="";o='<div style="text-align: left;padding: 0px 40px;">',o+='<div style="padding-top:7px;">'+a.messages[0]+"</div>",o+="</div>",swal({title:e.title,html:o,type:"warning",showCancelButton:!1,confirmButtonClass:"btn-success",confirmButtonText:"Ok!",allowOutsideClick:!1}).then(function(a){window.location.reload()})}else if("blacklisted"==a.type)userBuy=!0,localStorage.clear(),setTimeout(function(){window.location.href=window.location.href},500);else{var e=translatePurchaseFlowMessage("unauthorized_payment"),n=translatePurchaseFlowMessage("confirm_button_text");swal.close(),$("input[name='venda']").val(a.venda);var r=t(a.messages);o='<div style="text-align: left;padding: 0px 40px;">',o+='<div style="padding-top:7px;">- '+r+"</div>",o+="</div>",swal({title:e.title,html:e.message+": "+o,type:"error",showCancelButton:!1,confirmButtonClass:"btn-success",confirmButtonText:n.message}),resetTokenFields(),showRecaptcha(),resetRecaptcha()}},error:function(a){var e=translatePurchaseFlowMessage("fatal_error");if(void 0!==a.responseJSON&&a.responseJSON.errors){var t="",o=a.responseJSON.errors;return $.each(o,function(a,e){t+="<li>"+e[0]+"</li>"}),void swal(e.title,t,"error")}swal(e.title,e.message,"error")}})})}),$("[data-name='ano_exibido']").on("keyup",function(a){var e=$(this).val(),t=a.target.dataset.cartao;$("[data-name='ano'][data-cartao='"+t+"']").val("20"+e),$("[data-name='ano'][data-cartao='"+t+"']").trigger("keyup"),$("[data-name='ano'][data-cartao='"+t+"']").trigger("keydown"),$("[data-name='ano'][data-cartao='"+t+"']").trigger("change")}),$("#celular").trigger("countrychange")}),$('input[name="nacionalidade"]').val(brasileiro),$(document).ready(function(){$("#sem_email").change(function(){verificaCampoEmail()}),"undefined"!=typeof url_redirect&&void 0!==window.history.pushState&&url_redirect.length>0&&requestAnimationFrame(function(){window.history.pushState(null,null,url_atual),window.addEventListener("popstate",function(a){window.location.href=url_redirect})}),$(window).on("load",function(){document.getElementById("SbLsVMvBOTEw")||$("#ads_block").val(1)}),$('input[readonly][value=""]').attr("placeholder","---"),jQuery.fn.select2&&$(".select2").select2({width:"100%",language:"pt-BR"})});var iti=null;$("#celular").length>0&&(iti=intlTelInput(document.getElementById("celular"),{initialCountry:visitorData.countryCode,separateDialCode:!0,preferredCountries:["br"],utilsScript:"/js/intlTelInput.utils.js",customPlaceholder:function(a,e){return window.intlTelInputUtils.getExampleNumber(e.iso2,intlTelInputUtils.numberFormat.NATIONAL,1).replace(/[0-9]/g,0).replace("(","").replace(")","")}})),iti.promise.then(function(){maskTel()}),$("#celular").on("countrychange",function(){if($("#celular").removeAttr("maxlength"),$("#celular").attr("placeholder")){if($("#celular").val(""),"br"==iti.selectedCountryData.iso2)return $("#celular").attr("maxlength","00 00000-0000".length),$("#celular").attr("placeholder","00 00000-0000"),void maskTel();var a=$("#celular").attr("placeholder").replace(/[0-9]/g,0).replace("(","").replace(")","");return $("#celular").attr("maxlength",a.length),$("#celular").attr("placeholder",a),void maskTel(a)}var e=$("#celular").val().replace(/\D/g,"");$("#celular").attr("placeholder","00 00000-0000"),maskTel(),$("#celular").val(e)}),$("#celular").on("keyup",function(){if("br"==iti.selectedCountryData.iso2){if($("#celular").val().replace(/\D/g,"").length<11)return void $("#celular").mask("00 0000-00009");$("#celular").mask("00 00000-0000")}});